<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.07" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="p+2VUJDZAV1c6/cUW9zknA==" exportKeySalt="0aa836ad-365a-42a6-bda7-3204607a42c4" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpScen">
		<Field name="CecSessBehavior" type="java.lang.String">null</Field>
	<Field name="CecSessPollIntv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2018-06-21 03:05:51.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[eb381133-a316-4533-b59c-23d43614626a]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndPromptParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsMaterialized" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IDeploySpec" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IMapping" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IPackage" type="com.sunopsis.sql.DbInt"><![CDATA[21]]></Field>
	<Field name="IPop" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScenFolder" type="com.sunopsis.sql.DbInt"><![CDATA[21]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtScen" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2018-06-21 03:05:51.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="MaxCecSess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="RestartType" type="java.lang.String">null</Field>
	<Field name="ScenName" type="java.lang.String"><![CDATA[HEALTH_TRACKING_DATA_LOADER]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenSnapshotNo" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ScenVersion" type="java.lang.String"><![CDATA[001]]></Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3480e3b0-8d6e-429f-92a3-9884747194f3]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[T]]></Field>
	<Field name="VarLongValue" type="java.lang.String"><![CDATA['01-Jan-2000']]></Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp"><![CDATA[2018-03-19 00:00:00.0]]></Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c013e3f6-e149-4c7a-8c51-f19cc85463ef]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[H]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[ETLFORSELECTEDPROVIDER.SYSDATE]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_APPOINTMENT" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_APPOINTMENT" resource="DIM_APPOINTMENT" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4a428600-e918-47aa-92a6-8309ee8d559c]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_APPOINTMENT]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_APPOINTMENT]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_APPOINTMENT]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bda5b883-2eb9-40a8-9aba-45aa36a77f35]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[32e17020-ae68-4183-979b-547271661dd7]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_APPOINTMENT", "ODI_TARGET", "D") ?>
  (
    APPOINTMENT_FORM_ID ,
    APPOINTMENT_ID ,
    APPOINTMENT_STATUS ,
    APPOINTMENT_TYPE ,
    APPOINTMENT_REASON ,
    APPOINTMENT_RESULT_TYPE ,
    NOTIF_LEVEL ,
    ROOT_ID ,
    IS_FOLLOWED_UP ,
    FOLLOW_ID ,
    PROVIDER_ID 
  ) 
SELECT 
  INLINE_VIEW.FORM_ID ,
  INLINE_VIEW.ID ,
  CASE WHEN INLINE_VIEW.APPOINTMENT_STATUS = 'NOT_SCHEDULED'
       THEN 'Not Scheduled'
     WHEN INLINE_VIEW.APPOINTMENT_STATUS = 'RE_SCHEDULED'
       THEN 'Rescheduled'
     ELSE
       INITCAP(NVL(INLINE_VIEW.APPOINTMENT_STATUS,'Not Reported')) 
END ,
  NVL(REGEXP_REPLACE( REGEXP_REPLACE( INITCAP(REGEXP_REPLACE(INLINE_VIEW.APPOINTMENT_TYPE, '&', 'and') ), '[^0-9A-Za-z/&,]', '' ),'([[:lower:]])([[:upper:]])', '\1 \2' ), 'Not Reported' ) ,
  NVL(CASE 
	WHEN INLINE_VIEW.APP_REASON IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'AppointmentReason'
      	AND THERAP_DATA.ORDER_BY = INLINE_VIEW.APP_REASON
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END, 'Not Reported') ,
  NVL(HLTH_APPOINTMENT_RESULT_1.APPOINTMENT_RESULT_TYPE, -1) ,
  DECODE( INLINE_VIEW.NOTIF_LEVEL, 1, 'Low', 2, 'Medium', 3,'High', 'Not Reported') ,
  INLINE_VIEW.ROOT_ID ,
  NVL( DISTINCT_.IS_FOLLOWED_UP, 0) ,
  INLINE_VIEW.FOLLOW_ID ,
  INLINE_VIEW.PROV_ID  
FROM 
  ((
SELECT 
  HLTH_APPOINTMENTS.ID AS ID ,
  HLTH_APPOINTMENTS.APPOINTMENT_TYPE AS APPOINTMENT_TYPE ,
  HLTH_APPOINTMENTS.APP_REASON AS APP_REASON ,
  HLTH_APPOINTMENTS.FORM_ID AS FORM_ID ,
  HLTH_APPOINTMENTS.PROV_ID AS PROV_ID ,
  HLTH_APPOINTMENTS.EVENT_DATE AS EVENT_DATE ,
  HLTH_APPOINTMENTS.STATUS AS STATUS ,
  HLTH_APPOINTMENTS.NOTIF_LEVEL AS NOTIF_LEVEL ,
  HLTH_APPOINTMENTS.TEST AS TEST ,
  HLTH_APPOINTMENTS.FOLLOW_ID AS FOLLOW_ID ,
  HLTH_APPOINTMENTS.ROOT_ID AS ROOT_ID ,
  HLTH_APPOINTMENTS.APPOINTMENT_STATUS AS APPOINTMENT_STATUS ,
  DIM_PROVIDER.ID AS ID_1   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_APPOINTMENTS", "PROD7", "D") ?> HLTH_APPOINTMENTS  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_APPOINTMENTS.PROV_ID = DIM_PROVIDER.ID
WHERE
  (HLTH_APPOINTMENTS.TEST = 0 
AND  HLTH_APPOINTMENTS.STATUS = 3 
AND  HLTH_APPOINTMENTS.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND  HLTH_APPOINTMENTS.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  (
SELECT 
  HLTH_APPOINTMENT_RESULT.APPOINTMENT_ID AS APPOINTMENT_ID ,
  MIN(HLTH_APPOINTMENT_RESULT.APPOINTMENT_RESULT_TYPE) AS APPOINTMENT_RESULT_TYPE   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_APPOINTMENT_RESULT", "PROD7", "D") ?> HLTH_APPOINTMENT_RESULT   
GROUP BY
  HLTH_APPOINTMENT_RESULT.APPOINTMENT_ID 
  ) HLTH_APPOINTMENT_RESULT_1  
    ON  INLINE_VIEW.ID = HLTH_APPOINTMENT_RESULT_1.APPOINTMENT_ID
 )  LEFT OUTER JOIN  (
SELECT 
  DISTINCT 
  HLTH_APPOINTMENTS1.FOLLOW_ID AS FOLLOW_ID ,
  1 AS IS_FOLLOWED_UP   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_APPOINTMENTS", "PROD7", "D") ?> HLTH_APPOINTMENTS1   
WHERE
  (HLTH_APPOINTMENTS1.FOLLOW_ID IS NOT NULL
) 
  ) DISTINCT_  
    ON  INLINE_VIEW.ID = DISTINCT_.FOLLOW_ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[57101763-14c1-4b6c-8579-cb306c690661]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_APPOINTMENT]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_APPOINTMENT" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_APPOINTMENT" resource="FACT_APPOINTMENT" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[886ae491-60d0-4c60-b2fb-2384f796958f]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_APPOINTMENT]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_APPOINTMENT]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_APPOINTMENT]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[09fca936-5871-4b00-9bd9-25ff048fec61]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c7d43375-ffba-4688-9848-a95a0c93e074]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_APPOINTMENT", "ODI_TARGET", "D") ?>
  (
    APPOINTMENT_ID ,
    CLIENT_ID ,
    PROGRAM_ID ,
    TIME_ID ,
    PROVIDER_ID ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW.ID ,
  INLINE_VIEW.CLIENT_ID ,
  INLINE_VIEW.PGM_ID ,
  TO_NUMBER ( EXTRACT(YEAR FROM INLINE_VIEW.EVENT_DATE) || TO_CHAR(INLINE_VIEW.EVENT_DATE,'Q') || LPAD(EXTRACT( MONTH FROM  INLINE_VIEW.EVENT_DATE),2,0) ) ,
  INLINE_VIEW.PROV_ID ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  HLTH_APPOINTMENTS.ID AS ID ,
  HLTH_APPOINTMENTS.CLIENT_ID AS CLIENT_ID ,
  HLTH_APPOINTMENTS.PROV_ID AS PROV_ID ,
  HLTH_APPOINTMENTS.EVENT_DATE AS EVENT_DATE ,
  HLTH_APPOINTMENTS.PGM_ID AS PGM_ID ,
  HLTH_APPOINTMENTS.STATUS AS STATUS ,
  HLTH_APPOINTMENTS.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1 ,
  DIM_PROGRAM.ID AS ID_2   
FROM 
  (<?= odiRef.getObjectName("L", "HLTH_APPOINTMENTS", "PROD7", "D") ?> HLTH_APPOINTMENTS  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_APPOINTMENTS.PROV_ID = DIM_PROVIDER.ID
 )  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROGRAM", "ODI_TARGET", "D") ?> DIM_PROGRAM  
    ON  HLTH_APPOINTMENTS.PGM_ID = DIM_PROGRAM.ID
WHERE
  (HLTH_APPOINTMENTS.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_APPOINTMENTS.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_APPOINTMENTS.TEST = 0
AND HLTH_APPOINTMENTS.STATUS = 3
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW.CLIENT_ID = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5ecec934-0dba-43f2-99ed-5a07849bd1d5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_APPOINTMENT]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_SEIZURE_ACTION_BEHAVE_DESC" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_SEIZURE_ACTION_BEHAVE_DESC" resource="DIM_SEIZURE_ACTION_BEHAVE_DESC" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cb70bfa3-9ad7-4d5c-b820-580bfb67d66d]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_SEIZURE_ACTION_BEHAVE_DESC]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_SEIZURE_ACTION_BEHAVE_DESC]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_SEIZURE_ACTION_BEHAVE_DESC]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[84e17bff-de17-407a-9b78-08fcbfb4f114]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[73b16fea-bfae-4a21-9fa1-7c9dd107baf0]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_SEIZURE_ACTION_BEHAVE_DESC", "ODI_TARGET", "D") ?>
  (
    ID ,
    SEIZURE_ACTION_ID ,
    SEIZURE_ACTION_DESCRIPTION ,
    SEIZURE_BEHAVIOR_ID ,
    SEIZURE_BEHAVIOR_DESCRIPTION ,
    SEIZURE_DESCRIPTION_ID ,
    SEIZURE_DESC_DESCRIPTION 
  ) 
SELECT 
  LPAD( NVL(HLTH_SEIZURE_ACTION_1.ACTION,0),2,0 ) || LPAD(NVL(HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR, 0),2,0) || LPAD(NVL(HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION, 0),2,0) ,
  HLTH_SEIZURE_ACTION_1.ACTION ,
  --Here, translate() replaces newline, tab and carriage return with space.
translate(CASE 
	WHEN CASE WHEN HLTH_SEIZURE_ACTION_1.ACTION = 99 THEN 9999 ELSE HLTH_SEIZURE_ACTION_1.ACTION END IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'StaffActionDesc'
      	AND THERAP_DATA.ORDER_BY = CASE WHEN HLTH_SEIZURE_ACTION_1.ACTION = 99 THEN 9999 ELSE HLTH_SEIZURE_ACTION_1.ACTION END
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END, chr(10)||chr(11)||chr(13), ' ') ,
  HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR ,
  CASE 
	WHEN CASE WHEN HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR = 99 THEN 9999 ELSE  HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR END IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'PostSeizureDesc'
      	AND THERAP_DATA.ORDER_BY = CASE WHEN HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR = 99 THEN 9999 ELSE  HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR END
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END ,
  HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION ,
  CASE
  WHEN  HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION  in (23,24,25,26,27,28)
    THEN  'Respiration-'|| (SELECT DESCRIPTION
FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
WHERE THERAP_DATA.FIELD_KEY = 'SeizureDescResp'
      AND THERAP_DATA.CODE = CASE 
                                                          WHEN HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION = 99 
                                                           THEN 9999 
                                                          ELSE HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION
                                                        END
      AND THERAP_DATA.LOCALE = 'en')
  WHEN  HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION in (29,30,31,32,33)
    THEN  'Skin Color-' || (SELECT DESCRIPTION
FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
WHERE THERAP_DATA.FIELD_KEY = 'SeizureDescSkinCol'
      AND THERAP_DATA.CODE = CASE 
                                                            WHEN HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION = 99 
                                                             THEN 9999 
                                                            ELSE HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION
                                                           END
      AND THERAP_DATA.LOCALE = 'en')
  ELSE  (SELECT DESCRIPTION
FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
WHERE THERAP_DATA.FIELD_KEY = 'SeizureDesc'
      AND THERAP_DATA.CODE = CASE 
                                                     WHEN HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION  = 99 
                                                      THEN 9999 
                                                     ELSE HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION 
                                                  END
      AND THERAP_DATA.LOCALE = 'en') 
END  
FROM 
  (((
SELECT 
  HLTH_SEIZURE.ID AS ID ,
  HLTH_SEIZURE.EVENT_DATE AS EVENT_DATE ,
  HLTH_SEIZURE.STATUS AS STATUS ,
  HLTH_SEIZURE.TEST AS TEST   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE", "PROD7", "D") ?> HLTH_SEIZURE   
WHERE
  (HLTH_SEIZURE.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND  HLTH_SEIZURE.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND  HLTH_SEIZURE.TEST = 0
AND  HLTH_SEIZURE.STATUS = 3
) 
  ) HLTH_SEIZURE_1  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_DESCRIPTION.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_DESCRIPTION.DESCRIPTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_DESCRIPTION.DESCRIPTION
END) AS DESCRIPTION   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_DESCRIPTION", "PROD7", "D") ?> HLTH_SEIZURE_DESCRIPTION   
WHERE
  (HLTH_SEIZURE_DESCRIPTION.DESCRIPTION != 0
) 
GROUP BY
  HLTH_SEIZURE_DESCRIPTION.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_DESCRIPTION.DESCRIPTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_DESCRIPTION.DESCRIPTION
END) 
  ) HLTH_SEIZURE_DESCRIPTION_1  
    ON  HLTH_SEIZURE_1.ID = HLTH_SEIZURE_DESCRIPTION_1.SEIZURE_ID
 )  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_ACTION.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_ACTION.ACTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_ACTION.ACTION
END) AS ACTION   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_ACTION", "PROD7", "D") ?> HLTH_SEIZURE_ACTION   
WHERE
  (HLTH_SEIZURE_ACTION.ACTION != 0
) 
GROUP BY
  HLTH_SEIZURE_ACTION.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_ACTION.ACTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_ACTION.ACTION
END) 
  ) HLTH_SEIZURE_ACTION_1  
    ON  HLTH_SEIZURE_1.ID = HLTH_SEIZURE_ACTION_1.SEIZURE_ID
 )  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_BEHAVIOR.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_BEHAVIOR.BEHAVIOR = 9999
    THEN 99
  ELSE HLTH_SEIZURE_BEHAVIOR.BEHAVIOR
END) AS BEHAVIOR   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_BEHAVIOR", "PROD7", "D") ?> HLTH_SEIZURE_BEHAVIOR   
WHERE
  (HLTH_SEIZURE_BEHAVIOR.BEHAVIOR != 0
) 
GROUP BY
  HLTH_SEIZURE_BEHAVIOR.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_BEHAVIOR.BEHAVIOR = 9999
    THEN 99
  ELSE HLTH_SEIZURE_BEHAVIOR.BEHAVIOR
END) 
  ) HLTH_SEIZURE_BEHAVIOR_1  
    ON  HLTH_SEIZURE_1.ID = HLTH_SEIZURE_BEHAVIOR_1.SEIZURE_ID
GROUP BY
  HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION,HLTH_SEIZURE_ACTION_1.ACTION,HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR   ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[48d977a3-dd45-4c9b-b4ab-1da0d1c49aed]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_SEIZURE_ACTION_BEHAVE_DESC]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_SEIZURE_DETAILS" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_SEIZURE_DETAILS" resource="DIM_SEIZURE_DETAILS" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6b51119d-c7f2-4c07-8eab-9558174c5d24]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_SEIZURE_DETAILS]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_SEIZURE_DETAILS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_SEIZURE_DETAILS]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[125e0495-3653-48cb-9870-93d8bdd1d4c1]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dddc756e-c8f7-4b7b-bae8-a1361de5c74e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_SEIZURE_DETAILS", "ODI_TARGET", "D") ?>
  (
    SEIZURE_ID ,
    SEIZURE_FORM_ID ,
    DURATION_MIN ,
    DURATION_SEC ,
    NOTIF_LEVEL ,
    BEGIN_TIME_HOUR ,
    BEGIN_TIME_MIN ,
    BEGIN_TIME_AM_PM ,
    BEGIN_TIME_24_HOUR ,
    PROVIDER_ID 
  ) 
SELECT 
  HLTH_SEIZURE.ID ,
  HLTH_SEIZURE.FORM_ID ,
  HLTH_SEIZURE.DURATION_MIN ,
  HLTH_SEIZURE.DURATION_SEC ,
  DECODE( HLTH_SEIZURE.NOTIF_LEVEL, 1, 'Low', 2, 'Medium', 3,'High', 'Not Reported') ,
  HLTH_SEIZURE.BEGIN_TIME_HOUR ,
  HLTH_SEIZURE.BEGIN_TIME_MIN ,
  HLTH_SEIZURE.BEGIN_TIME_AM_PM ,
  CASE
  WHEN  ( TO_NUMBER(HLTH_SEIZURE.BEGIN_TIME_HOUR) = 12 AND  HLTH_SEIZURE.BEGIN_TIME_AM_PM = 'am' )
   THEN 0
  WHEN  ( (TO_NUMBER(HLTH_SEIZURE.BEGIN_TIME_HOUR)) IN (1,2,3,4,5,6,7,8,9,10,11) AND  HLTH_SEIZURE.BEGIN_TIME_AM_PM = 'pm')
   THEN  TO_NUMBER( HLTH_SEIZURE.BEGIN_TIME_HOUR ) + 12
  ELSE  TO_NUMBER(HLTH_SEIZURE.BEGIN_TIME_HOUR)
END ,
  HLTH_SEIZURE.PROV_ID  
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE", "PROD7", "D") ?> HLTH_SEIZURE   
WHERE
  (HLTH_SEIZURE.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_SEIZURE.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_SEIZURE.TEST= 0
AND HLTH_SEIZURE.STATUS = 3
)   ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[de3e3fde-2bb2-47c2-b0b7-22f492d6eaeb]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_SEIZURE_DETAILS]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_SEIZURE" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_SEIZURE" resource="FACT_SEIZURE" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[378b32d9-060f-4cba-909d-fa71fc8681d6]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_SEIZURE]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_SEIZURE]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_SEIZURE]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9f764ae0-60d7-43c0-b772-67d0cf19e528]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a61dd5d1-7b9d-4a2a-9be4-2516148d4b5e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_SEIZURE", "ODI_TARGET", "D") ?>
  (
    SEIZURE_ID ,
    CLIENT_ID ,
    PROVIDER_ID ,
    PROGRAM_ID ,
    TIME_ID ,
    ACTION_BEHAVE_DESC_ID ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW.ID ,
  INLINE_VIEW.CLIENT_ID ,
  INLINE_VIEW.PROV_ID ,
  INLINE_VIEW.PGM_ID ,
  TO_NUMBER ( EXTRACT(YEAR FROM INLINE_VIEW.EVENT_DATE) || TO_CHAR( INLINE_VIEW.EVENT_DATE, 'Q') || LPAD(EXTRACT( MONTH FROM INLINE_VIEW.EVENT_DATE),2,0) ) ,
  LPAD(NVL(HLTH_SEIZURE_ACTION_1.ACTION,0),2,0) || LPAD(NVL( HLTH_SEIZURE_BEHAVIOR_1.BEHAVIOR, 0),2,0) || LPAD(NVL( HLTH_SEIZURE_DESCRIPTION_1.DESCRIPTION, 0),2,0) ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  ((((
SELECT 
  HLTH_SEIZURE.ID AS ID ,
  HLTH_SEIZURE.CLIENT_ID AS CLIENT_ID ,
  HLTH_SEIZURE.PROV_ID AS PROV_ID ,
  HLTH_SEIZURE.EVENT_DATE AS EVENT_DATE ,
  HLTH_SEIZURE.PGM_ID AS PGM_ID ,
  HLTH_SEIZURE.STATUS AS STATUS ,
  HLTH_SEIZURE.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1 ,
  DIM_PROGRAM.ID AS ID_2   
FROM 
  (<?= odiRef.getObjectName("L", "HLTH_SEIZURE", "PROD7", "D") ?> HLTH_SEIZURE  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_SEIZURE.PROV_ID = DIM_PROVIDER.ID
 )  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROGRAM", "ODI_TARGET", "D") ?> DIM_PROGRAM  
    ON  HLTH_SEIZURE.PGM_ID = DIM_PROGRAM.ID
WHERE
  (HLTH_SEIZURE.EVENT_DATE  >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_SEIZURE.EVENT_DATE  <= SYSDATE
AND HLTH_SEIZURE.TEST  = 0
AND HLTH_SEIZURE.STATUS  = 3
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_DESCRIPTION.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_DESCRIPTION.DESCRIPTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_DESCRIPTION.DESCRIPTION
END) AS DESCRIPTION   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_DESCRIPTION", "PROD7", "D") ?> HLTH_SEIZURE_DESCRIPTION   
WHERE
  (HLTH_SEIZURE_DESCRIPTION.DESCRIPTION != 0
) 
GROUP BY
  HLTH_SEIZURE_DESCRIPTION.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_DESCRIPTION.DESCRIPTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_DESCRIPTION.DESCRIPTION
END) 
  ) HLTH_SEIZURE_DESCRIPTION_1  
    ON  INLINE_VIEW.ID = HLTH_SEIZURE_DESCRIPTION_1.SEIZURE_ID
 )  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_ACTION.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_ACTION.ACTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_ACTION.ACTION
END) AS ACTION   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_ACTION", "PROD7", "D") ?> HLTH_SEIZURE_ACTION   
WHERE
  (HLTH_SEIZURE_ACTION.ACTION != 0
) 
GROUP BY
  HLTH_SEIZURE_ACTION.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_ACTION.ACTION = 9999
    THEN 99
  ELSE HLTH_SEIZURE_ACTION.ACTION
END) 
  ) HLTH_SEIZURE_ACTION_1  
    ON  INLINE_VIEW.ID = HLTH_SEIZURE_ACTION_1.SEIZURE_ID
 )  LEFT OUTER JOIN  (
SELECT 
  HLTH_SEIZURE_BEHAVIOR.SEIZURE_ID AS SEIZURE_ID ,
  (CASE 
  WHEN HLTH_SEIZURE_BEHAVIOR.BEHAVIOR = 9999
    THEN 99
  ELSE HLTH_SEIZURE_BEHAVIOR.BEHAVIOR
END) AS BEHAVIOR   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_SEIZURE_BEHAVIOR", "PROD7", "D") ?> HLTH_SEIZURE_BEHAVIOR   
WHERE
  (HLTH_SEIZURE_BEHAVIOR.BEHAVIOR != 0
) 
GROUP BY
  HLTH_SEIZURE_BEHAVIOR.SEIZURE_ID,(CASE 
  WHEN HLTH_SEIZURE_BEHAVIOR.BEHAVIOR = 9999
    THEN 99
  ELSE HLTH_SEIZURE_BEHAVIOR.BEHAVIOR
END) 
  ) HLTH_SEIZURE_BEHAVIOR_1  
    ON  INLINE_VIEW.ID = HLTH_SEIZURE_BEHAVIOR_1.SEIZURE_ID
 )  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW.CLIENT_ID = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fc825c75-8b67-42fc-b1ed-4e733dbbbaeb]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_SEIZURE]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_HEIGHT_WEIGHT" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_HEIGHT_WEIGHT" resource="DIM_HEIGHT_WEIGHT" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4c67b599-7963-4c30-a544-b6e72c8d2ce5]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_HEIGHT_WEIGHT]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_HEIGHT_WEIGHT]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_HEIGHT_WEIGHT]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[759af5a3-620a-47d5-9ffa-44a674a4f0eb]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ce789883-903d-45df-a1ab-50049e15612b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_HEIGHT_WEIGHT", "ODI_TARGET", "D") ?>
  (
    ID ,
    HEIGHT_WEIGHT_FORM_ID ,
    NOTIF_LEVEL ,
    HEIGHT ,
    WEIGHT ,
    LATEST_WEIGHT ,
    LATEST_WEIGHT_DATE ,
    OLDEST_WEIGHT ,
    OLDEST_WEIGHT_DATE ,
    ROW_NUMBER ,
    BMI ,
    PROVIDER_ID 
  ) 
SELECT 
  HLTH_WEIGHT_1.ID_1 ,
  HLTH_WEIGHT_1.FORM_ID_1 ,
  HLTH_WEIGHT_1.COL_5 ,
  CASE 
 WHEN   HLTH_WEIGHT_1.COL_6 IS NOT NULL AND HLTH_WEIGHT_1.COL_7 IS NOT NULL
  THEN  HLTH_WEIGHT_1.COL_6 || '''' || HLTH_WEIGHT_1.COL_7 || '"'
END ,
  HLTH_WEIGHT_1.WEIGHT_1 ,
  HLTH_WEIGHT_1.COL ,
  HLTH_WEIGHT_1.COL_1 ,
  HLTH_WEIGHT_1.COL_2 ,
  HLTH_WEIGHT_1.COL_3 ,
  HLTH_WEIGHT_1.COL_4 ,
  (ROUND(( HLTH_WEIGHT_1.WEIGHT_1 * 703) / NULLIF(POWER((NVL2( HLTH_WEIGHT_1.COL_6,  HLTH_WEIGHT_1.COL_6 * 12, 0) + NVL( HLTH_WEIGHT_1.COL_7, 0)), 2), 0), 2)) ,
  HLTH_WEIGHT_1.PROV_ID  
FROM 
  (
SELECT 
  HLTH_WEIGHT.ID AS ID ,
  HLTH_WEIGHT.WEIGHT AS WEIGHT ,
  HLTH_WEIGHT.HEIGHT_FOOT AS HEIGHT_FOOT ,
  HLTH_WEIGHT.HEIGHT_INCH AS HEIGHT_INCH ,
  HLTH_WEIGHT.FORM_ID AS FORM_ID ,
  HLTH_WEIGHT.CLIENT_ID AS CLIENT_ID ,
  HLTH_WEIGHT.PROV_ID AS PROV_ID ,
  HLTH_WEIGHT.EVENT_DATE AS EVENT_DATE ,
  HLTH_WEIGHT.PGM_ID AS PGM_ID ,
  HLTH_WEIGHT.STATUS AS STATUS ,
  HLTH_WEIGHT.NOTIF_LEVEL AS NOTIF_LEVEL ,
  HLTH_WEIGHT.TEST AS TEST ,
  HLTH_WEIGHT.ID AS ID_1 ,
  HLTH_WEIGHT.WEIGHT AS WEIGHT_1 ,
  LAST_VALUE (HLTH_WEIGHT.WEIGHT) OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                                       EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                                       EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE), 
                                       HLTH_WEIGHT.PROV_ID,  
                                       HLTH_WEIGHT.PGM_ID 
                                       ORDER BY HLTH_WEIGHT.EVENT_DATE, HLTH_WEIGHT.ID 
                                     ) AS COL ,
  LAST_VALUE (HLTH_WEIGHT.EVENT_DATE) OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                                       EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                                       EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE), 
                                       HLTH_WEIGHT.PROV_ID,  
                                       HLTH_WEIGHT.PGM_ID 
                                       ORDER BY HLTH_WEIGHT.EVENT_DATE, HLTH_WEIGHT.ID 
                                     ) AS COL_1 ,
  FIRST_VALUE (HLTH_WEIGHT.WEIGHT) OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                                        EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                                        EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE), 
                                        HLTH_WEIGHT.PROV_ID, HLTH_WEIGHT.PGM_ID 
                                        ORDER BY   HLTH_WEIGHT.EVENT_DATE, HLTH_WEIGHT.ID 
                                      ) AS COL_2 ,
  FIRST_VALUE ( HLTH_WEIGHT.EVENT_DATE) OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                                        EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                                        EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE), 
                                        HLTH_WEIGHT.PROV_ID, HLTH_WEIGHT.PGM_ID 
                                        ORDER BY   HLTH_WEIGHT.EVENT_DATE, HLTH_WEIGHT.ID
                                      ) AS COL_3 ,
  ROW_NUMBER() OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                    EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                    EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE),
                    HLTH_WEIGHT.PROV_ID ,
                    HLTH_WEIGHT.PGM_ID 
                    ORDER BY HLTH_WEIGHT.EVENT_DATE DESC, HLTH_WEIGHT.ID DESC 
                 ) AS COL_4 ,
  DECODE( HLTH_WEIGHT.NOTIF_LEVEL, 1, 'Low', 2, 'Medium', 3,'High', 'Not Reported') AS COL_5 ,
  HLTH_WEIGHT.FORM_ID AS FORM_ID_1 ,
  CASE WHEN HLTH_WEIGHT.HEIGHT_FOOT IS NULL AND HLTH_WEIGHT.HEIGHT_INCH
IS NOT NULL THEN 0
ELSE HLTH_WEIGHT.HEIGHT_FOOT
END AS COL_6 ,
  CASE WHEN HLTH_WEIGHT.HEIGHT_INCH IS NULL AND HLTH_WEIGHT.HEIGHT_FOOT
IS NOT NULL THEN 0
ELSE HLTH_WEIGHT.HEIGHT_INCH
END AS COL_7   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_WEIGHT", "PROD7", "D") ?> HLTH_WEIGHT   
WHERE
  (HLTH_WEIGHT.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_WEIGHT.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_WEIGHT.TEST = 0
AND HLTH_WEIGHT.STATUS = 3
) 
  ) HLTH_WEIGHT_1   
WHERE
  (HLTH_WEIGHT_1.COL_4 = 1
)   ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[80be0911-2339-497e-997b-7f024a031ee3]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_HEIGHT_WEIGHT]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_HEIGHT_WEIGHT" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_HEIGHT_WEIGHT" resource="FACT_HEIGHT_WEIGHT" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[586b4bf3-6d84-432a-a812-49a00daa3e21]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_HEIGHT_WEIGHT]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_HEIGHT_WEIGHT]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_HEIGHT_WEIGHT]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d1f56d57-a35e-4ea8-a65d-50fc9350dce4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0bbb607b-229a-44b8-8974-88391b833a1d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_HEIGHT_WEIGHT", "ODI_TARGET", "D") ?>
  (
    HW_ID ,
    CLIENT_ID ,
    PROVIDER_ID ,
    PROGRAM_ID ,
    TIME_ID ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW.ID_1 ,
  INLINE_VIEW.CLIENT_ID ,
  INLINE_VIEW.PROV_ID ,
  INLINE_VIEW.PGM_ID ,
  TO_NUMBER ( EXTRACT(YEAR FROM INLINE_VIEW.EVENT_DATE) || TO_CHAR( INLINE_VIEW.EVENT_DATE, 'Q') || LPAD(EXTRACT( MONTH FROM INLINE_VIEW.EVENT_DATE),2,0) ) ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) >= 0 
    THEN FLOOR (MONTHS_BETWEEN (INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE) / 12)
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  DIM_PROGRAM.ID AS ID ,
  HLTH_WEIGHT_1.ID AS ID_1 ,
  HLTH_WEIGHT_1.CLIENT_ID AS CLIENT_ID ,
  HLTH_WEIGHT_1.PROV_ID AS PROV_ID ,
  HLTH_WEIGHT_1.EVENT_DATE AS EVENT_DATE ,
  HLTH_WEIGHT_1.PGM_ID AS PGM_ID ,
  HLTH_WEIGHT_1.STATUS AS STATUS ,
  HLTH_WEIGHT_1.TEST AS TEST ,
  HLTH_WEIGHT_1.COL AS COL ,
  DIM_PROVIDER.ID AS ID_2   
FROM 
  <?= odiRef.getObjectName("L", "DIM_PROGRAM", "ODI_TARGET", "D") ?> DIM_PROGRAM  INNER JOIN  ((
SELECT 
  HLTH_WEIGHT.ID AS ID ,
  HLTH_WEIGHT.CLIENT_ID AS CLIENT_ID ,
  HLTH_WEIGHT.PROV_ID AS PROV_ID ,
  HLTH_WEIGHT.EVENT_DATE AS EVENT_DATE ,
  HLTH_WEIGHT.PGM_ID AS PGM_ID ,
  HLTH_WEIGHT.STATUS AS STATUS ,
  HLTH_WEIGHT.TEST AS TEST ,
  ROW_NUMBER() OVER ( PARTITION BY  HLTH_WEIGHT.CLIENT_ID, 
                    EXTRACT( MONTH FROM HLTH_WEIGHT.EVENT_DATE), 
                    EXTRACT( YEAR FROM HLTH_WEIGHT.EVENT_DATE),
                    HLTH_WEIGHT.PROV_ID ,
                    HLTH_WEIGHT.PGM_ID 
                    ORDER BY HLTH_WEIGHT.EVENT_DATE DESC, HLTH_WEIGHT.ID DESC 
                  ) AS COL   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_WEIGHT", "PROD7", "D") ?> HLTH_WEIGHT   
WHERE
  (HLTH_WEIGHT.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_WEIGHT.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_WEIGHT.TEST = 0
AND HLTH_WEIGHT.STATUS = 3
) 
  ) HLTH_WEIGHT_1  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_WEIGHT_1.PROV_ID = DIM_PROVIDER.ID
 )  
    ON  DIM_PROGRAM.ID = HLTH_WEIGHT_1.PGM_ID
WHERE
  (HLTH_WEIGHT_1.COL = 1
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW.CLIENT_ID = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[87b1c9e2-fd59-4a9e-bbb2-ea0dee25d8b2]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_HEIGHT_WEIGHT]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_SKIN_WOUND_1" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_SKIN_WOUND" resource="DIM_SKIN_WOUND" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[96e609be-706d-405f-8ec2-27c329546363]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_SKIN_WOUND]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_SKIN_WOUND]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_SKIN_WOUND]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[283e1dff-63ff-44ca-b0b1-663f9504f9cd]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a8fa9bac-3751-432b-afc9-962dee67e864]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_SKIN_WOUND", "ODI_TARGET", "D") ?>
  (
    SKIN_WOUND_UNIQUE_ID ,
    SKIN_WOUND_FORM_ID ,
    WOUND_ID ,
    WOUND_TYPE ,
    WOUND_SIZE_LENGTH ,
    WOUND_SIZE_WIDTH ,
    WOUND_SIZE_DEPTH ,
    BODY_PART ,
    IS_WOUND_INFECTED ,
    NOTIF_LEVEL ,
    PROVIDER_ID 
  ) 
SELECT 
  (TO_NUMBER(HLTH_WOUND_ASSESSMENT_1.ID || NVL(HLTH_WA_BODY_PART_1.BODY_PART,88))) ,
  HLTH_WOUND_ASSESSMENT_1.FORM_ID ,
  HLTH_WOUND_ASSESSMENT_1.ID ,
  (NVL(CASE 
	WHEN HLTH_WOUND_ASSESSMENT_1.WOUND_TYPE IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'WoundType'
      	AND THERAP_DATA.ORDER_BY = HLTH_WOUND_ASSESSMENT_1.WOUND_TYPE
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END,'Not Reported')) ,
  HLTH_WOUND_ASSESSMENT_1.WOUND_SIZE_LENGTH ,
  HLTH_WOUND_ASSESSMENT_1.WOUND_SIZE_WIDTH ,
  HLTH_WOUND_ASSESSMENT_1.WOUND_SIZE_DEPTH ,
  (NVL(CASE 
	WHEN HLTH_WA_BODY_PART_1.BODY_PART IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'BodyPart'
      	AND THERAP_DATA.ORDER_BY = HLTH_WA_BODY_PART_1.BODY_PART
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END,'Not Reported')) ,
  (CASE 
  WHEN HLTH_WOUND_ASSESSMENT_1.WOUND_INFECTED = 0  
    THEN 'Not Infected'
  WHEN HLTH_WOUND_ASSESSMENT_1.WOUND_INFECTED = 1 
    THEN 'Infected' 
  ELSE 'Not Reported'
END) ,
  (DECODE( HLTH_WOUND_ASSESSMENT_1.NOTIF_LEVEL, 1, 'Low', 2, 'Medium', 3,'High', 'Not Reported')) ,
  HLTH_WOUND_ASSESSMENT_1.PROV_ID  
FROM 
  (
SELECT 
  HLTH_WOUND_ASSESSMENT.ID AS ID ,
  HLTH_WOUND_ASSESSMENT.WOUND_TYPE AS WOUND_TYPE ,
  HLTH_WOUND_ASSESSMENT.WOUND_SIZE_LENGTH AS WOUND_SIZE_LENGTH ,
  HLTH_WOUND_ASSESSMENT.WOUND_SIZE_WIDTH AS WOUND_SIZE_WIDTH ,
  HLTH_WOUND_ASSESSMENT.WOUND_SIZE_DEPTH AS WOUND_SIZE_DEPTH ,
  HLTH_WOUND_ASSESSMENT.FORM_ID AS FORM_ID ,
  HLTH_WOUND_ASSESSMENT.PROV_ID AS PROV_ID ,
  HLTH_WOUND_ASSESSMENT.EVENT_DATE AS EVENT_DATE ,
  HLTH_WOUND_ASSESSMENT.STATUS AS STATUS ,
  HLTH_WOUND_ASSESSMENT.NOTIF_LEVEL AS NOTIF_LEVEL ,
  HLTH_WOUND_ASSESSMENT.TEST AS TEST ,
  HLTH_WOUND_ASSESSMENT.WOUND_INFECTED AS WOUND_INFECTED   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_WOUND_ASSESSMENT", "PROD7", "D") ?> HLTH_WOUND_ASSESSMENT   
WHERE
  (HLTH_WOUND_ASSESSMENT.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_WOUND_ASSESSMENT.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_WOUND_ASSESSMENT.TEST = 0 
AND HLTH_WOUND_ASSESSMENT.STATUS = 3
) 
  ) HLTH_WOUND_ASSESSMENT_1  LEFT OUTER JOIN  (
SELECT 
  HLTH_WA_BODY_PART.WOUND_ASSESSMENT_ID AS WOUND_ASSESSMENT_ID ,
  HLTH_WA_BODY_PART.BODY_PART AS BODY_PART   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_WA_BODY_PART", "PROD7", "D") ?> HLTH_WA_BODY_PART   
GROUP BY
  HLTH_WA_BODY_PART.WOUND_ASSESSMENT_ID,HLTH_WA_BODY_PART.BODY_PART 
  ) HLTH_WA_BODY_PART_1  
    ON  HLTH_WOUND_ASSESSMENT_1.ID=HLTH_WA_BODY_PART_1.WOUND_ASSESSMENT_ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c57cc1ce-8a08-4d1c-90ab-8c853212f1d6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_SKIN_WOUND_1]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_SKIN_WOUND" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_SKIN_WOUND" resource="FACT_SKIN_WOUND" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[010551f8-96fc-405f-b372-f20e883d20d5]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_SKIN_WOUND]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_SKIN_WOUND]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_SKIN_WOUND]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e7181fd9-7eee-4e50-b03b-0807a3cb06ae]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c3f4eea6-0ada-41c1-8a16-fd712d8d35da]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_SKIN_WOUND", "ODI_TARGET", "D") ?>
  (
    SKIN_WOUND_UNIQUE_ID ,
    CLIENT_ID ,
    PROGRAM_ID ,
    TIME_ID ,
    PROVIDER_ID ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  (INLINE_VIEW.ID || NVL(HLTH_WA_BODY_PART_1.BODY_PART,88)) ,
  INLINE_VIEW.CLIENT_ID ,
  INLINE_VIEW.PGM_ID ,
  TO_NUMBER ( EXTRACT(YEAR FROM INLINE_VIEW.EVENT_DATE) || TO_CHAR( INLINE_VIEW.EVENT_DATE, 'Q') || LPAD(EXTRACT( MONTH FROM INLINE_VIEW.EVENT_DATE),2,0) ) ,
  INLINE_VIEW.PROV_ID ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  ((
SELECT 
  HLTH_WOUND_ASSESSMENT.ID AS ID ,
  HLTH_WOUND_ASSESSMENT.CLIENT_ID AS CLIENT_ID ,
  HLTH_WOUND_ASSESSMENT.PROV_ID AS PROV_ID ,
  HLTH_WOUND_ASSESSMENT.EVENT_DATE AS EVENT_DATE ,
  HLTH_WOUND_ASSESSMENT.PGM_ID AS PGM_ID ,
  HLTH_WOUND_ASSESSMENT.STATUS AS STATUS ,
  HLTH_WOUND_ASSESSMENT.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1 ,
  DIM_PROGRAM.ID AS ID_2   
FROM 
  (<?= odiRef.getObjectName("L", "HLTH_WOUND_ASSESSMENT", "PROD7", "D") ?> HLTH_WOUND_ASSESSMENT  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_WOUND_ASSESSMENT.PROV_ID = DIM_PROVIDER.ID
 )  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROGRAM", "ODI_TARGET", "D") ?> DIM_PROGRAM  
    ON  HLTH_WOUND_ASSESSMENT.PGM_ID = DIM_PROGRAM.ID
WHERE
  (HLTH_WOUND_ASSESSMENT.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_WOUND_ASSESSMENT.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_WOUND_ASSESSMENT.TEST = 0 
AND HLTH_WOUND_ASSESSMENT.STATUS = 3
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  (
SELECT 
  HLTH_WA_BODY_PART.WOUND_ASSESSMENT_ID AS WOUND_ASSESSMENT_ID ,
  HLTH_WA_BODY_PART.BODY_PART AS BODY_PART   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_WA_BODY_PART", "PROD7", "D") ?> HLTH_WA_BODY_PART   
GROUP BY
  HLTH_WA_BODY_PART.WOUND_ASSESSMENT_ID,HLTH_WA_BODY_PART.BODY_PART 
  ) HLTH_WA_BODY_PART_1  
    ON  INLINE_VIEW.ID = HLTH_WA_BODY_PART_1.WOUND_ASSESSMENT_ID
 )  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW.CLIENT_ID = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[11f79b69-9a37-4fe1-a7de-1c2dafb53eeb]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_SKIN_WOUND]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_IDF_DIAGNOSIS" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_IDF_DIAGNOSIS" resource="FACT_IDF_DIAGNOSIS" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[52d40aa1-5d30-4e74-b851-ddd5f916029b]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_IDF_DIAGNOSIS]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT IDF DIAGNOSIS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_IDF_DIAGNOSIS]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1e5eb2fb-4c69-46df-98e1-e6c64dce3346]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[078de112-03c3-4ad5-802d-a2f94053a690]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_IDF_DIAGNOSIS", "ODI_TARGET", "D") ?>
  (
    CLIENT_ID ,
    PROV_ID ,
    TIME_KEY ,
    OVERSIGHT_PROV_ID ,
    CLIENT_UNIQUE_ID ,
    ID 
  ) 
SELECT 
  DIM_IDF_DIAGNOSIS_1.CLIENT_ID ,
  DIM_IDF_DIAGNOSIS_1.PROV_ID ,
  DEMOGRAPHIC_TIME.ID ,
  CASE WHEN DIM_CLIENT_OVERSIGHT.OVERSIGHT_PROV_ID IS NULL
THEN -1
ELSE DIM_CLIENT_OVERSIGHT.OVERSIGHT_PROV_ID
END ,
  DIM_CLIENT_OVERSIGHT.UNIQUE_KEY ,
  DIM_IDF_DIAGNOSIS_1.ID  
FROM 
  <?= odiRef.getObjectName("L", "DEMOGRAPHIC_TIME", "ODI_TARGET", "D") ?> DEMOGRAPHIC_TIME  INNER JOIN  ((
SELECT 
  DIM_IDF_DIAGNOSIS.CLIENT_ID AS CLIENT_ID ,
  DIM_IDF_DIAGNOSIS.PROV_ID AS PROV_ID ,
  DIM_IDF_DIAGNOSIS.ID AS ID ,
  DIM_IDF_DIAGNOSIS.DIAGNOSIS_DATE AS DIAGNOSIS_DATE ,
  DIM_IDF_DIAGNOSIS.RESOLVED_DATE AS RESOLVED_DATE   
FROM 
  <?= odiRef.getObjectName("L", "DIM_IDF_DIAGNOSIS", "ODI_TARGET", "D") ?> DIM_IDF_DIAGNOSIS   
WHERE
  (DIM_IDF_DIAGNOSIS.DIAGNOSIS_DATE >= TO_DATE('2000-01-01', 'YYYY-MM-DD') 
AND ( DIM_IDF_DIAGNOSIS.RESOLVED_DATE >=  DIM_IDF_DIAGNOSIS.DIAGNOSIS_DATE
      OR DIM_IDF_DIAGNOSIS.RESOLVED_DATE IS NULL )
) 
  ) DIM_IDF_DIAGNOSIS_1  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT_OVERSIGHT", "ODI_TARGET", "D") ?> DIM_CLIENT_OVERSIGHT  
    ON  DIM_IDF_DIAGNOSIS_1.CLIENT_ID = DIM_CLIENT_OVERSIGHT.CLIENT_ID
 )  
    ON  DEMOGRAPHIC_TIME.MONTH_INT <> -1 
AND  DIM_IDF_DIAGNOSIS_1.DIAGNOSIS_DATE <= DEMOGRAPHIC_TIME.END_DATE
AND ( DIM_IDF_DIAGNOSIS_1.RESOLVED_DATE IS NULL OR DIM_IDF_DIAGNOSIS_1.RESOLVED_DATE  >= DEMOGRAPHIC_TIME.BEGIN_DATE )
     ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c36f8693-31b3-4f20-a5b6-6a8be35a50fc]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[9]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_IDF_DIAGNOSIS]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="DIM_MEDICATION_HISTORY" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="DIM_MEDICATION_HISTORY" resource="DIM_MEDICATION_HISTORY" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[39bae64b-61f6-47ed-b522-1e5064e4d122]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[DIM_MEDICATION_HISTORY]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[DIM_MEDICATION_HISTORY]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[DIM_MEDICATION_HISTORY]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1c64f762-5cc1-4ef2-86d2-6cd3e0567119]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[963af259-4a9b-4a71-892a-da0ddbf7323c]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "DIM_MEDICATION_HISTORY", "ODI_TARGET", "D") ?>
  (
    ID ,
    MEDICATION_HISTORY_FORM_ID ,
    BEGIN_DATE ,
    END_DATE ,
    EVENT_DATE ,
    EFFECTIVENESS ,
    NOTIF_LEVEL ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER ,
    MEDICATION_NAME ,
    MEDICATION_SUB_CATEGORY ,
    MEDICATION_CATEGORY_TEXT ,
    MEDICATION_TYPE_TEXT 
  ) 
SELECT 
  HLTH_MH_1.ID ,
  HLTH_MH_1.FORM_ID ,
  HLTH_MH_1.BEGIN_DATE ,
  HLTH_MH_1.END_DATE ,
  HLTH_MH_1.EVENT_DATE ,
  HLTH_MH_1.EFFECTIVENESS ,
  DECODE( HLTH_MH_1.NOTIF_LEVEL, 1, 'Low', 2, 'Medium', 3,'High', 'Not Reported') ,
  (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN CLIENT.BIRTH_DATE IS NULL OR HLTH_MH_1.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( HLTH_MH_1.EVENT_DATE, CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END ,
  TRIM(HLTH_MH_1.MEDICATION_NAME) ,
  HLTH_MH_1.MEDICATION_SUB_CATEGORY ,
  NVL(HLTH_MH_1.MEDICATION_CATEGORY,'Not Reported') ,
  (decode(HLTH_MH_1.MEDICATION_TYPE, 0, 'Other',
                                    1, 'Scheduled (Medication)',
                                    2, 'PRN (Medication)',
                                    3, 'Scheduled (Treatment)',
                                    4, 'PRN (Treatment)'  ))  
FROM 
  (
SELECT 
  HLTH_MH.ID AS ID ,
  HLTH_MH.BEGIN_DATE AS BEGIN_DATE ,
  HLTH_MH.END_DATE AS END_DATE ,
  HLTH_MH.FORM_ID AS FORM_ID ,
  HLTH_MH.MEDICATION_NAME AS MEDICATION_NAME ,
  HLTH_MH.CLIENT_ID AS CLIENT_ID ,
  HLTH_MH.EVENT_DATE AS EVENT_DATE ,
  HLTH_MH.STATUS AS STATUS ,
  HLTH_MH.NOTIF_LEVEL AS NOTIF_LEVEL ,
  HLTH_MH.TEST AS TEST ,
  HLTH_MH.EFFECTIVENESS AS EFFECTIVENESS ,
  HLTH_MH.MEDICATION_TYPE AS MEDICATION_TYPE ,
  HLTH_MH.MEDICATION_CATEGORY AS MEDICATION_CATEGORY ,
  HLTH_MH.MEDICATION_SUB_CATEGORY AS MEDICATION_SUB_CATEGORY   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_MH", "PROD7", "D") ?> HLTH_MH   
WHERE
  (HLTH_MH.TEST = 0 AND HLTH_MH.STATUS = 3
) 
  ) HLTH_MH_1  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "CLIENT", "PROD7", "D") ?> CLIENT  
    ON  HLTH_MH_1.CLIENT_ID = CLIENT.ID
     ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a125353a-cd15-4fde-809e-5d2bbc692cb5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load DIM_MEDICATION_HISTORY]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_MEDICATION_HISTORY" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_MEDICATION_HISTORY" resource="FACT_MEDICATION_HISTORY" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d0044571-b31b-4131-a7d4-3e7f87a998cb]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_MEDICATION_HISTORY]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_MEDICATION_HISTORY]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_MEDICATION_HISTORY]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e235afb5-fd56-4bb6-a3a1-1ca318976c52]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7fba5478-6c04-4e60-ae8f-ce4e16e34f9d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_MEDICATION_HISTORY", "ODI_TARGET", "D") ?>
  (
    MH_ID ,
    CLIENT_ID ,
    PROGRAM_ID ,
    TIME_ID ,
    PROVIDER_ID ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW.ID_1 ,
  INLINE_VIEW.CLIENT_ID ,
  INLINE_VIEW.PGM_ID ,
  TO_NUMBER ( EXTRACT(YEAR FROM INLINE_VIEW.EVENT_DATE) || TO_CHAR( INLINE_VIEW.EVENT_DATE,'Q') || LPAD(EXTRACT( MONTH FROM INLINE_VIEW.EVENT_DATE),2,0) ) ,
  INLINE_VIEW.PROV_ID ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW.EVENT_DATE IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW.EVENT_DATE, DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  DIM_PROGRAM.ID AS ID ,
  HLTH_MH.ID AS ID_1 ,
  HLTH_MH.CLIENT_ID AS CLIENT_ID ,
  HLTH_MH.PROV_ID AS PROV_ID ,
  HLTH_MH.EVENT_DATE AS EVENT_DATE ,
  HLTH_MH.PGM_ID AS PGM_ID ,
  HLTH_MH.STATUS AS STATUS ,
  HLTH_MH.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_2   
FROM 
  <?= odiRef.getObjectName("L", "DIM_PROGRAM", "ODI_TARGET", "D") ?> DIM_PROGRAM  INNER JOIN  (<?= odiRef.getObjectName("L", "HLTH_MH", "PROD7", "D") ?> HLTH_MH  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_MH.PROV_ID = DIM_PROVIDER.ID
 )  
    ON  DIM_PROGRAM.ID = HLTH_MH.PGM_ID
WHERE
  (HLTH_MH.EVENT_DATE >= #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND HLTH_MH.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND HLTH_MH.TEST = 0
AND HLTH_MH.STATUS = 3
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW.CLIENT_ID = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[202e1af9-9d4e-44e7-b919-a0167377a0ff]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_MEDICATION_HISTORY]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="FACT_IE_FLUID" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <node name="FACT_IE_BM" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <node name="FACT_IE_BA" type="IKM" km="IKM Oracle Insert.GLOBAL">
      <option name="CREATE_TARGET_TABLE" value="false" default="true"/>
      <option name="INSERT_HINT" value="APPEND PARALLEL" default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
      <option name="TRUNCATE_TARGET_TABLE" value="false" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
   </node>
   <target name="FACT_IE_FLUID" resource="FACT_IE_FLUID" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
   <target name="FACT_IE_BM" resource="FACT_IE_BM" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
   <target name="FACT_IE_BA" resource="FACT_IE_BA" model="TARGET" logicalSchema="ODI_TARGET" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c06ad11e-caee-4d42-873a-aae666ada04b]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[TARGET]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FACT_IE_BA]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[FACT_IE]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FACT_IE_BA]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[587241d2-c08e-4e87-9f20-d3e055e24760]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[65aac56e-3076-44dc-b212-90616ab9d250]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[ODI_TARGET_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_IE_BA", "ODI_TARGET", "D") ?>
  (
    PROVIDER_ID ,
    PROGRAM_ID ,
    CLIENT_ID ,
    TIME_ID ,
    BOWEL_AID_TYPE ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW_1.PROV_ID ,
  NVL(INLINE_VIEW_1.PGM_ID,-1) ,
  INLINE_VIEW_1.CLIENT_ID ,
  INLINE_VIEW_1.TIME_ID ,
  CASE 
	WHEN INLINE_VIEW_1.BA_TYPE IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'BowelAids'
      	AND THERAP_DATA.ORDER_BY = INLINE_VIEW_1.BA_TYPE
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM')) AS TIME_ID ,
  INLINE_VIEW.ID_1 AS PROV_ID ,
  INLINE_VIEW.PGM_ID AS PGM_ID ,
  INLINE_VIEW.CLIENT_ID AS CLIENT_ID ,
  HLTH_IE_ROW.BOWEL_AIDS AS BA_TYPE ,
  TRUNC(INLINE_VIEW.EVENT_DATE,'mm') AS EVENT_DATE_MONTH   
FROM 
  (
SELECT 
  HLTH_INTAKE_ELIMINATION.ID AS ID ,
  HLTH_INTAKE_ELIMINATION.CLIENT_ID AS CLIENT_ID ,
  HLTH_INTAKE_ELIMINATION.PROV_ID AS PROV_ID ,
  HLTH_INTAKE_ELIMINATION.EVENT_DATE AS EVENT_DATE ,
  HLTH_INTAKE_ELIMINATION.PGM_ID AS PGM_ID ,
  HLTH_INTAKE_ELIMINATION.STATUS AS STATUS ,
  HLTH_INTAKE_ELIMINATION.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_INTAKE_ELIMINATION", "PROD7", "D") ?> HLTH_INTAKE_ELIMINATION  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_INTAKE_ELIMINATION.PROV_ID = DIM_PROVIDER.ID
WHERE
  (HLTH_INTAKE_ELIMINATION.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND  HLTH_INTAKE_ELIMINATION.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND  HLTH_INTAKE_ELIMINATION.TEST = 0 
AND  HLTH_INTAKE_ELIMINATION.STATUS = 0
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "HLTH_IE_ROW", "PROD7", "D") ?> HLTH_IE_ROW  
    ON  INLINE_VIEW.ID = HLTH_IE_ROW.INTAKE_ELIMINATION_ID
WHERE
  (HLTH_IE_ROW.BOWEL_AIDS IS NOT NULL
) 
GROUP BY
  (TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM'))),INLINE_VIEW.ID_1,INLINE_VIEW.PGM_ID,INLINE_VIEW.CLIENT_ID,HLTH_IE_ROW.BOWEL_AIDS,(TRUNC(INLINE_VIEW.EVENT_DATE,'mm')) 
  ) INLINE_VIEW_1  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW_1.CLIENT_ID  = DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4aef22e2-9e29-40c3-bf02-cc0eae8b7a53]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_IE_BA]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_IE_BM", "ODI_TARGET", "D") ?>
  (
    PROVIDER_ID ,
    PROGRAM_ID ,
    CLIENT_ID ,
    TIME_ID ,
    BOWEL_MOVEMENT_TYPE ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW_1.PROV_ID ,
  NVL(INLINE_VIEW_1.PGM_ID,-1) ,
  INLINE_VIEW_1.CLIENT_ID ,
  INLINE_VIEW_1.TIME_ID ,
  CASE 
	WHEN INLINE_VIEW_1.BM_TYPE IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'BMType'
      	AND THERAP_DATA.ORDER_BY = INLINE_VIEW_1.BM_TYPE
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END ,
  (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM')) AS TIME_ID ,
  INLINE_VIEW.ID_1 AS PROV_ID ,
  INLINE_VIEW.PGM_ID AS PGM_ID ,
  INLINE_VIEW.CLIENT_ID AS CLIENT_ID ,
  HLTH_IE_ROW.BOWEL_MOVEMENT_TYPE AS BM_TYPE ,
  TRUNC(INLINE_VIEW.EVENT_DATE,'mm') AS EVENT_DATE_MONTH   
FROM 
  (
SELECT 
  HLTH_INTAKE_ELIMINATION.ID AS ID ,
  HLTH_INTAKE_ELIMINATION.CLIENT_ID AS CLIENT_ID ,
  HLTH_INTAKE_ELIMINATION.PROV_ID AS PROV_ID ,
  HLTH_INTAKE_ELIMINATION.EVENT_DATE AS EVENT_DATE ,
  HLTH_INTAKE_ELIMINATION.PGM_ID AS PGM_ID ,
  HLTH_INTAKE_ELIMINATION.STATUS AS STATUS ,
  HLTH_INTAKE_ELIMINATION.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_INTAKE_ELIMINATION", "PROD7", "D") ?> HLTH_INTAKE_ELIMINATION  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_INTAKE_ELIMINATION.PROV_ID = DIM_PROVIDER.ID
WHERE
  (HLTH_INTAKE_ELIMINATION.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND  HLTH_INTAKE_ELIMINATION.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND  HLTH_INTAKE_ELIMINATION.TEST = 0 
AND  HLTH_INTAKE_ELIMINATION.STATUS = 0
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "HLTH_IE_ROW", "PROD7", "D") ?> HLTH_IE_ROW  
    ON  INLINE_VIEW.ID = HLTH_IE_ROW.INTAKE_ELIMINATION_ID
WHERE
  (HLTH_IE_ROW.BOWEL_MOVEMENT_TYPE IS NOT NULL
) 
GROUP BY
  (TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM'))),INLINE_VIEW.ID_1,INLINE_VIEW.PGM_ID,INLINE_VIEW.CLIENT_ID,HLTH_IE_ROW.BOWEL_MOVEMENT_TYPE,(TRUNC(INLINE_VIEW.EVENT_DATE,'mm')) 
  ) INLINE_VIEW_1  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT  
    ON  INLINE_VIEW_1.CLIENT_ID =  DIM_CLIENT.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[247e8bbc-3772-435e-8e61-c91d7a291581]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_IE_BM]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[PROD7]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ODI_TARGET]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO <?= odiRef.getObjectName("L", "FACT_IE_FLUID", "ODI_TARGET", "D") ?>
  (
    PROVIDER_ID ,
    PROGRAM_ID ,
    CLIENT_ID ,
    TIME_ID ,
    FLUID_TYPE ,
    AGE_AT_EVENT ,
    AGE_RANGE ,
    AGE_RANGE_SORT_ORDER 
  ) 
SELECT 
  INLINE_VIEW_1.PROV_ID ,
  NVL(INLINE_VIEW_1.PGM_ID,-1) ,
  INLINE_VIEW_1.CLIENT_ID ,
  INLINE_VIEW_1.TIME_ID ,
  CASE 
	WHEN INLINE_VIEW_1.FLUID_TYPE IS NULL THEN 'Not Reported'
ELSE 
	(NVL(
	( SELECT DESCRIPTION
	FROM <?=odiRef.getSchemaName("PROD7", "D") ?>.THERAP_DATA 
	WHERE THERAP_DATA.FIELD_KEY = 'FluidType'
      	AND THERAP_DATA.ORDER_BY = INLINE_VIEW_1.FLUID_TYPE
      	AND THERAP_DATA.LOCALE = 'en' )
	,'Not Reported')
	)
END ,
  (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) ,
  CASE WHEN (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 'Unknown'
        WHEN (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 'Invalid'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 3 THEN '0-3'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=4 and   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN '4-5'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN '6-17'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN '18-21'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN '22-40'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN '41-65'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN '66-85'
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN '86+'
END ,
  CASE 
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=0 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 2 THEN 1
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=3 and   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 5 THEN 2
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=6 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 17 THEN 3
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=18 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=21 THEN 4
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=22 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <=40 THEN 5
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=41 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 65 THEN 6
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=66 AND   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) <= 85 THEN 7
        WHEN   (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) >=86 THEN 8
        WHEN (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) < 0 THEN 9
        WHEN (CASE 
  WHEN DIM_CLIENT1.BIRTH_DATE IS NULL OR INLINE_VIEW_1.EVENT_DATE_MONTH IS NULL
    THEN -1
  WHEN months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) >= 0 
    THEN FLOOR ( months_between ( INLINE_VIEW_1.EVENT_DATE_MONTH , DIM_CLIENT1.BIRTH_DATE ) / 12 )
  ELSE -1
END) IS NULL THEN 10
END  
FROM 
  (
SELECT 
  TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM')) AS TIME_ID ,
  INLINE_VIEW.ID_1 AS PROV_ID ,
  INLINE_VIEW.PGM_ID AS PGM_ID ,
  INLINE_VIEW.CLIENT_ID AS CLIENT_ID ,
  TRUNC(INLINE_VIEW.EVENT_DATE,'mm') AS EVENT_DATE_MONTH ,
  HLTH_IE_ROW.FLUID_TYPE AS FLUID_TYPE   
FROM 
  (
SELECT 
  HLTH_INTAKE_ELIMINATION.ID AS ID ,
  HLTH_INTAKE_ELIMINATION.CLIENT_ID AS CLIENT_ID ,
  HLTH_INTAKE_ELIMINATION.PROV_ID AS PROV_ID ,
  HLTH_INTAKE_ELIMINATION.EVENT_DATE AS EVENT_DATE ,
  HLTH_INTAKE_ELIMINATION.PGM_ID AS PGM_ID ,
  HLTH_INTAKE_ELIMINATION.STATUS AS STATUS ,
  HLTH_INTAKE_ELIMINATION.TEST AS TEST ,
  DIM_PROVIDER.ID AS ID_1   
FROM 
  <?= odiRef.getObjectName("L", "HLTH_INTAKE_ELIMINATION", "PROD7", "D") ?> HLTH_INTAKE_ELIMINATION  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_PROVIDER", "ODI_TARGET", "D") ?> DIM_PROVIDER  
    ON  HLTH_INTAKE_ELIMINATION.PROV_ID = DIM_PROVIDER.ID
WHERE
  (HLTH_INTAKE_ELIMINATION.EVENT_DATE >=  #ETLFORSELECTEDPROVIDER.HEALTH_TRACKING_START_DD_MON_YYYY
AND  HLTH_INTAKE_ELIMINATION.EVENT_DATE <= :ETLFORSELECTEDPROVIDER.SYSDATE 
AND  HLTH_INTAKE_ELIMINATION.TEST = 0 
AND  HLTH_INTAKE_ELIMINATION.STATUS = 0
) 
  ) INLINE_VIEW  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "HLTH_IE_ROW", "PROD7", "D") ?> HLTH_IE_ROW  
    ON  INLINE_VIEW.ID = HLTH_IE_ROW.INTAKE_ELIMINATION_ID
WHERE
  (HLTH_IE_ROW.FLUID_TYPE IS NOT NULL
) 
GROUP BY
  (TO_NUMBER (TO_CHAR(INLINE_VIEW.EVENT_DATE,'YYYYQMM'))),INLINE_VIEW.ID_1,INLINE_VIEW.PGM_ID,INLINE_VIEW.CLIENT_ID,(TRUNC(INLINE_VIEW.EVENT_DATE,'mm')),HLTH_IE_ROW.FLUID_TYPE 
  ) INLINE_VIEW_1  INNER JOIN  <?= odiRef.getObjectName("L", "DIM_CLIENT", "ODI_TARGET", "D") ?> DIM_CLIENT1  
    ON  INLINE_VIEW_1.CLIENT_ID = DIM_CLIENT1.ID
      ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d25b5baf-4f6f-4d1d-85bc-5308a8383eb3]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Load FACT_IE_FLUID]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Insert]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENFOLDER.21]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7d70b876-0c1c-4c4f-9bad-664ace47eb88]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[ETL_PLAN_2018.1.0]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_SCENFOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[17]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PACKAGE.21]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7c5e108c-f981-4d57-9609-3c856435d67d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[Develop_current.INITIAL_LOAD.HEALTH TRACKING DATA LOADER]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[15.12.27]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCEN.148]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[eb381133-a316-4533-b59c-23d43614626a]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[Develop_current.INITIAL_LOAD.HEALTH TRACKING DATA LOADER.HEALTH_TRACKING_DATA_LOADER Version 001]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE.SNP_SCEN]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[15.12.27.39]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.0]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4a428600-e918-47aa-92a6-8309ee8d559c]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.1]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[886ae491-60d0-4c60-b2fb-2384f796958f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.2]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[cb70bfa3-9ad7-4d5c-b820-580bfb67d66d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.3]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6b51119d-c7f2-4c07-8eab-9558174c5d24]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.4]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[378b32d9-060f-4cba-909d-fa71fc8681d6]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.5]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4c67b599-7963-4c30-a544-b6e72c8d2ce5]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.6]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[586b4bf3-6d84-432a-a812-49a00daa3e21]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.7]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[96e609be-706d-405f-8ec2-27c329546363]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.8]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[010551f8-96fc-405f-b372-f20e883d20d5]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.9]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[52d40aa1-5d30-4e74-b851-ddd5f916029b]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.10]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[39bae64b-61f6-47ed-b522-1e5064e4d122]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.11]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d0044571-b31b-4131-a7d4-3e7f87a998cb]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.148.12]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c06ad11e-caee-4d42-873a-aae666ada04b]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[85]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.07]]></Field>
</Object>
</SunopsisExport>
